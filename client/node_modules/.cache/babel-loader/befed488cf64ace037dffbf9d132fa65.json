{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { getToday } from \"../../../tools/time\";\n\nconst getEmptyWorkList = () => {\n  return [{\n    workTime: -1\n  }];\n};\n\nconst isEmptyWorkList = workList => {\n  var _workList$;\n\n  return workList ? ((_workList$ = workList[0]) === null || _workList$ === void 0 ? void 0 : _workList$.workTime) === -1 : true;\n};\n\nconst checkWorkList = workList => isEmptyWorkList(workList) ? getEmptyWorkList() : workList;\n\nexport const useUpdateWork = (user, date) => {\n  _s();\n\n  // if (getToday() !== date) window.localStorage.removeItem(\"workList\");\n  const initList = !user && window.localStorage.getItem(\"workList\") ? JSON.parse(window.localStorage.getItem(\"workList\")) : [];\n  const [workList, setWorkList] = useState();\n  useEffect(() => {\n    getAndUpdateWorkList();\n  }, [date, user]);\n\n  const getAndUpdateWorkList = async () => {\n    let resWorkList;\n\n    if (user) {\n      const data = await axios.get(`/api/${user}/${date}/worklist/worklist`);\n      resWorkList = checkWorkList(data === null || data === void 0 ? void 0 : data.data);\n    } else {\n      resWorkList = JSON.parse(localStorage.getItem(\"workList\"));\n    }\n\n    setWorkList(resWorkList);\n  };\n\n  const updateWorkList = _workList => {\n    _workList = checkWorkList(_workList);\n    setWorkList(_workList);\n\n    if (user) {\n      const config = {\n        headers: {\n          \"x-access-token\": localStorage.getItem(\"access_token\")\n        }\n      };\n      axios.post(`/api/${user}/${date}/worklist/worklist`, {\n        user: \"TEST\",\n        value: _workList\n      }, config);\n    } else window.localStorage.setItem(\"workList\", JSON.stringify(_workList)); // else window.localStorage.removeItem(\"workList\");\n\n  };\n\n  return [workList, updateWorkList];\n}; //:id꼴이 괜히있는게 아니다 ㅋㅋ;\n//여기서 useState가 동작을 안한다,. RET1 -> RET 로 ㄴ넘어가지가 않는다. 하\n\n_s(useUpdateWork, \"JK4s//pofYMHoAup+tILQomfvO4=\");","map":{"version":3,"sources":["/home/invidam/hamburger_calender/src/hooks/workList/work/useUpdateWork.js"],"names":["useEffect","useState","axios","getToday","getEmptyWorkList","workTime","isEmptyWorkList","workList","checkWorkList","useUpdateWork","user","date","initList","window","localStorage","getItem","JSON","parse","setWorkList","getAndUpdateWorkList","resWorkList","data","get","updateWorkList","_workList","config","headers","post","value","setItem","stringify"],"mappings":";;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,qBAAzB;;AAEA,MAAMC,gBAAgB,GAAG,MAAM;AAC7B,SAAO,CAAC;AAAEC,IAAAA,QAAQ,EAAE,CAAC;AAAb,GAAD,CAAP;AACD,CAFD;;AAGA,MAAMC,eAAe,GAAIC,QAAD;AAAA;;AAAA,SACtBA,QAAQ,GAAG,eAAAA,QAAQ,CAAC,CAAD,CAAR,0DAAaF,QAAb,MAA0B,CAAC,CAA9B,GAAkC,IADpB;AAAA,CAAxB;;AAGA,MAAMG,aAAa,GAAID,QAAD,IACpBD,eAAe,CAACC,QAAD,CAAf,GAA4BH,gBAAgB,EAA5C,GAAiDG,QADnD;;AAGA,OAAO,MAAME,aAAa,GAAG,CAACC,IAAD,EAAOC,IAAP,KAAgB;AAAA;;AAC3C;AACA,QAAMC,QAAQ,GACZ,CAACF,IAAD,IAASG,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,CAAT,GACIC,IAAI,CAACC,KAAL,CAAWJ,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,CAAX,CADJ,GAEI,EAHN;AAIA,QAAM,CAACR,QAAD,EAAWW,WAAX,IAA0BjB,QAAQ,EAAxC;AACAD,EAAAA,SAAS,CAAC,MAAM;AACdmB,IAAAA,oBAAoB;AACrB,GAFQ,EAEN,CAACR,IAAD,EAAOD,IAAP,CAFM,CAAT;;AAIA,QAAMS,oBAAoB,GAAG,YAAY;AACvC,QAAIC,WAAJ;;AACA,QAAIV,IAAJ,EAAU;AACR,YAAMW,IAAI,GAAG,MAAMnB,KAAK,CAACoB,GAAN,CAAW,QAAOZ,IAAK,IAAGC,IAAK,oBAA/B,CAAnB;AACAS,MAAAA,WAAW,GAAGZ,aAAa,CAACa,IAAD,aAACA,IAAD,uBAACA,IAAI,CAAEA,IAAP,CAA3B;AACD,KAHD,MAGO;AACLD,MAAAA,WAAW,GAAGJ,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAX,CAAd;AACD;;AACDG,IAAAA,WAAW,CAACE,WAAD,CAAX;AACD,GATD;;AAWA,QAAMG,cAAc,GAAIC,SAAD,IAAe;AACpCA,IAAAA,SAAS,GAAGhB,aAAa,CAACgB,SAAD,CAAzB;AAEAN,IAAAA,WAAW,CAACM,SAAD,CAAX;;AACA,QAAId,IAAJ,EAAU;AACR,YAAMe,MAAM,GAAG;AACbC,QAAAA,OAAO,EAAE;AAAE,4BAAkBZ,YAAY,CAACC,OAAb,CAAqB,cAArB;AAApB;AADI,OAAf;AAGAb,MAAAA,KAAK,CAACyB,IAAN,CACG,QAAOjB,IAAK,IAAGC,IAAK,oBADvB,EAEE;AACED,QAAAA,IAAI,EAAE,MADR;AAEEkB,QAAAA,KAAK,EAAEJ;AAFT,OAFF,EAMEC,MANF;AAQD,KAZD,MAYOZ,MAAM,CAACC,YAAP,CAAoBe,OAApB,CAA4B,UAA5B,EAAwCb,IAAI,CAACc,SAAL,CAAeN,SAAf,CAAxC,EAhB6B,CAiBpC;;AACD,GAlBD;;AAmBA,SAAO,CAACjB,QAAD,EAAWgB,cAAX,CAAP;AACD,CA1CM,C,CA2CP;AACA;;GA5Cad,a","sourcesContent":["import { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { getToday } from \"../../../tools/time\";\n\nconst getEmptyWorkList = () => {\n  return [{ workTime: -1 }];\n};\nconst isEmptyWorkList = (workList) =>\n  workList ? workList[0]?.workTime === -1 : true;\n\nconst checkWorkList = (workList) =>\n  isEmptyWorkList(workList) ? getEmptyWorkList() : workList;\n\nexport const useUpdateWork = (user, date) => {\n  // if (getToday() !== date) window.localStorage.removeItem(\"workList\");\n  const initList =\n    !user && window.localStorage.getItem(\"workList\")\n      ? JSON.parse(window.localStorage.getItem(\"workList\"))\n      : [];\n  const [workList, setWorkList] = useState();\n  useEffect(() => {\n    getAndUpdateWorkList();\n  }, [date, user]);\n\n  const getAndUpdateWorkList = async () => {\n    let resWorkList;\n    if (user) {\n      const data = await axios.get(`/api/${user}/${date}/worklist/worklist`);\n      resWorkList = checkWorkList(data?.data);\n    } else {\n      resWorkList = JSON.parse(localStorage.getItem(\"workList\"));\n    }\n    setWorkList(resWorkList);\n  };\n\n  const updateWorkList = (_workList) => {\n    _workList = checkWorkList(_workList);\n\n    setWorkList(_workList);\n    if (user) {\n      const config = {\n        headers: { \"x-access-token\": localStorage.getItem(\"access_token\") },\n      };\n      axios.post(\n        `/api/${user}/${date}/worklist/worklist`,\n        {\n          user: \"TEST\",\n          value: _workList,\n        },\n        config\n      );\n    } else window.localStorage.setItem(\"workList\", JSON.stringify(_workList));\n    // else window.localStorage.removeItem(\"workList\");\n  };\n  return [workList, updateWorkList];\n};\n//:id꼴이 괜히있는게 아니다 ㅋㅋ;\n//여기서 useState가 동작을 안한다,. RET1 -> RET 로 ㄴ넘어가지가 않는다. 하\n"]},"metadata":{},"sourceType":"module"}