{"ast":null,"code":"import _regeneratorRuntime from\"/home/invidam/hamburger_calender/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/invidam/hamburger_calender/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/invidam/hamburger_calender/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import{API}from\"../../../tools/API\";import{LocalStroage}from\"../../../tools/LocalStorage\";// import { getToday } from \"../../../tools/time\";\nexport var isEmptyTimeObj=function isEmptyTimeObj(timeObj){return timeObj?!Object.keys(timeObj).length:true;};// !timeObj || timeObj.hour === -1 || timeObj.minute === -1;\nvar getEmptyTimeObj=function getEmptyTimeObj(){return{};};var checkTimeObj=function checkTimeObj(timeObj){return isEmptyTimeObj(timeObj)?getEmptyTimeObj():timeObj;};// const getInitList = (user, key) =>\n//   !user && window.localStorage.getItem(key)\n//     ? JSON.parse(window.localStorage.getItem(key))\n//     : null;\nvar getNowTimeHHMM=function getNowTimeHHMM(){return new Date().toTimeString().split(\":\").slice(0,2).map(function(numChar){return parseInt(numChar);});};export var useRecordTime=function useRecordTime(key,user,date){// const initVal = getInitList(user, key);\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),recordTime=_useState2[0],setRecordTime=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isRecordTimeLoading=_useState4[0],setLoad=_useState4[1];var getRecordTime=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var resTimeObj,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!user){_context.next=13;break;}setLoad(true);_context.next=5;return API.recordTime(user,date,key).get();case 5:data=_context.sent;setLoad(false);resTimeObj=checkTimeObj(data===null||data===void 0?void 0:data.data);console.log(\"USERECORDTIME, data catch\");console.log(\"USERECORDTIME DATA CATCH AFT\");setRecordTime(resTimeObj);_context.next=16;break;case 13:resTimeObj=LocalStroage.recordTime(key).get();console.log(\"USERECORDTIME DATA CATCH AFT\");setRecordTime(resTimeObj);case 16:_context.next=22;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](0);setLoad(false);alert(_context.t0);case 22:case\"end\":return _context.stop();}}},_callee,null,[[0,18]]);}));return function getRecordTime(){return _ref.apply(this,arguments);};}();useEffect(function(){console.log(\"GET EVENT START\");getRecordTime();return function(){return setLoad(false);};},[date,user]);var setTime=function setTime(timeObj){timeObj=checkTimeObj(timeObj);return{create:function(){var _create=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setRecordTime(timeObj);if(!user){_context2.next=6;break;}_context2.next=4;return API.recordTime(user,date,key).create(timeObj);case 4:_context2.next=7;break;case 6:LocalStroage.recordTime(key).set(timeObj);case 7:case\"end\":return _context2.stop();}}},_callee2);}));function create(){return _create.apply(this,arguments);}return create;}(),edit:function(){var _edit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setRecordTime(timeObj);if(!user){_context3.next=6;break;}_context3.next=4;return API.recordTime(user,date,key).edit(timeObj);case 4:_context3.next=7;break;case 6:LocalStroage.recordTime(key).set(timeObj);case 7:case\"end\":return _context3.stop();}}},_callee3);}));function edit(){return _edit.apply(this,arguments);}return edit;}(),delete:function(){var _delete2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setRecordTime({});if(!user){_context4.next=6;break;}_context4.next=4;return API.recordTime(user,date,key).delete();case 4:_context4.next=7;break;case 6:LocalStroage.recordTime(key).set({});case 7:case\"end\":return _context4.stop();}}},_callee4);}));function _delete(){return _delete2.apply(this,arguments);}return _delete;}()};//\n// if (user)\n//   API.post(`/api/${user}/${date}/worklist/record-time/${key}`, {\n//     value: timeObj,\n//   });\n// else window.localStorage.setItem(key, JSON.stringify(timeObj));\n// setRecordTime(timeObj);\n};var onClick=function onClick(event){console.log(\"ONCLICK RECORDTIME\");event.preventDefault();var _getNowTimeHHMM=getNowTimeHHMM(),_getNowTimeHHMM2=_slicedToArray(_getNowTimeHHMM,2),hour=_getNowTimeHHMM2[0],minute=_getNowTimeHHMM2[1];var timeObj={hour:hour,minute:minute};setTime(timeObj).create();};return[recordTime,onClick,setTime,isRecordTimeLoading];};","map":{"version":3,"sources":["/home/invidam/hamburger_calender/client/src/hooks/workList/time/useRecordTime.js"],"names":["useState","useEffect","API","LocalStroage","isEmptyTimeObj","timeObj","Object","keys","length","getEmptyTimeObj","checkTimeObj","getNowTimeHHMM","Date","toTimeString","split","slice","map","numChar","parseInt","useRecordTime","key","user","date","recordTime","setRecordTime","isRecordTimeLoading","setLoad","getRecordTime","get","data","resTimeObj","console","log","alert","setTime","create","set","edit","delete","onClick","event","preventDefault","hour","minute"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport { API } from \"../../../tools/API\";\nimport { LocalStroage } from \"../../../tools/LocalStorage\";\n// import { getToday } from \"../../../tools/time\";\n\nexport const isEmptyTimeObj = (timeObj) =>\n  timeObj ? !Object.keys(timeObj).length : true;\n// !timeObj || timeObj.hour === -1 || timeObj.minute === -1;\n\nconst getEmptyTimeObj = () => {\n  return {};\n};\n\nconst checkTimeObj = (timeObj) =>\n  isEmptyTimeObj(timeObj) ? getEmptyTimeObj() : timeObj;\n// const getInitList = (user, key) =>\n//   !user && window.localStorage.getItem(key)\n//     ? JSON.parse(window.localStorage.getItem(key))\n//     : null;\n\nconst getNowTimeHHMM = () =>\n  new Date()\n    .toTimeString()\n    .split(\":\")\n    .slice(0, 2)\n    .map((numChar) => parseInt(numChar));\nexport const useRecordTime = (key, user, date) => {\n  // const initVal = getInitList(user, key);\n  const [recordTime, setRecordTime] = useState();\n  const [isRecordTimeLoading, setLoad] = useState(false);\n\n  const getRecordTime = async () => {\n    try {\n      let resTimeObj;\n      if (user) {\n        setLoad(true);\n        const data = await API.recordTime(user, date, key).get();\n        setLoad(false);\n        resTimeObj = checkTimeObj(data?.data);\n        console.log(\"USERECORDTIME, data catch\");\n        console.log(\"USERECORDTIME DATA CATCH AFT\");\n        setRecordTime(resTimeObj);\n      } else {\n        resTimeObj = LocalStroage.recordTime(key).get();\n        console.log(\"USERECORDTIME DATA CATCH AFT\");\n        setRecordTime(resTimeObj);\n      }\n    } catch (error) {\n      setLoad(false);\n      alert(error);\n    }\n  };\n  useEffect(() => {\n    console.log(\"GET EVENT START\");\n    getRecordTime();\n    return () => setLoad(false);\n  }, [date, user]);\n\n  const setTime = (timeObj) => {\n    timeObj = checkTimeObj(timeObj);\n    return {\n      create: async () => {\n        setRecordTime(timeObj);\n        if (user) await API.recordTime(user, date, key).create(timeObj);\n        else LocalStroage.recordTime(key).set(timeObj);\n      },\n      edit: async () => {\n        setRecordTime(timeObj);\n        if (user) await API.recordTime(user, date, key).edit(timeObj);\n        else LocalStroage.recordTime(key).set(timeObj);\n      },\n      delete: async () => {\n        setRecordTime({});\n        if (user) await API.recordTime(user, date, key).delete();\n        else LocalStroage.recordTime(key).set({});\n      },\n    };\n    //\n    // if (user)\n    //   API.post(`/api/${user}/${date}/worklist/record-time/${key}`, {\n    //     value: timeObj,\n    //   });\n    // else window.localStorage.setItem(key, JSON.stringify(timeObj));\n    // setRecordTime(timeObj);\n  };\n  const onClick = (event) => {\n    console.log(\"ONCLICK RECORDTIME\");\n    event.preventDefault();\n    const [hour, minute] = getNowTimeHHMM();\n    const timeObj = { hour, minute };\n    setTime(timeObj).create();\n  };\n  return [recordTime, onClick, setTime, isRecordTimeLoading];\n};\n"]},"metadata":{},"sourceType":"module"}