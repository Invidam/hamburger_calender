{"ast":null,"code":"const {\n  sign: signOneShot,\n  verify: verifyOneShot\n} = require('crypto');\n\nconst {\n  KEYOBJECT\n} = require('../help/consts');\n\nconst {\n  edDSASupported\n} = require('../help/runtime_support');\n\nconst sign = ({\n  [KEYOBJECT]: keyObject\n}, payload) => {\n  if (typeof payload === 'string') {\n    payload = Buffer.from(payload);\n  }\n\n  return signOneShot(undefined, payload, keyObject);\n};\n\nconst verify = ({\n  [KEYOBJECT]: keyObject\n}, payload, signature) => {\n  return verifyOneShot(undefined, payload, keyObject, signature);\n};\n\nmodule.exports = (JWA, JWK) => {\n  if (edDSASupported) {\n    JWA.sign.set('EdDSA', sign);\n    JWA.verify.set('EdDSA', verify);\n\n    JWK.OKP.sign.EdDSA = key => key.private && JWK.OKP.verify.EdDSA(key);\n\n    JWK.OKP.verify.EdDSA = key => (key.use === 'sig' || key.use === undefined) && key.keyObject.asymmetricKeyType.startsWith('ed');\n  }\n};","map":{"version":3,"sources":["/home/invidam/hamburger_calender/client/node_modules/jose/lib/jwa/eddsa.js"],"names":["sign","signOneShot","verify","verifyOneShot","require","KEYOBJECT","edDSASupported","keyObject","payload","Buffer","from","undefined","signature","module","exports","JWA","JWK","set","OKP","EdDSA","key","private","use","asymmetricKeyType","startsWith"],"mappings":"AAAA,MAAM;AAAEA,EAAAA,IAAI,EAAEC,WAAR;AAAqBC,EAAAA,MAAM,EAAEC;AAA7B,IAA+CC,OAAO,CAAC,QAAD,CAA5D;;AAEA,MAAM;AAAEC,EAAAA;AAAF,IAAgBD,OAAO,CAAC,gBAAD,CAA7B;;AACA,MAAM;AAAEE,EAAAA;AAAF,IAAqBF,OAAO,CAAC,yBAAD,CAAlC;;AAEA,MAAMJ,IAAI,GAAG,CAAC;AAAE,GAACK,SAAD,GAAaE;AAAf,CAAD,EAA6BC,OAA7B,KAAyC;AACpD,MAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC;AAC/BA,IAAAA,OAAO,GAAGC,MAAM,CAACC,IAAP,CAAYF,OAAZ,CAAV;AACD;;AACD,SAAOP,WAAW,CAACU,SAAD,EAAYH,OAAZ,EAAqBD,SAArB,CAAlB;AACD,CALD;;AAOA,MAAML,MAAM,GAAG,CAAC;AAAE,GAACG,SAAD,GAAaE;AAAf,CAAD,EAA6BC,OAA7B,EAAsCI,SAAtC,KAAoD;AACjE,SAAOT,aAAa,CAACQ,SAAD,EAAYH,OAAZ,EAAqBD,SAArB,EAAgCK,SAAhC,CAApB;AACD,CAFD;;AAIAC,MAAM,CAACC,OAAP,GAAiB,CAACC,GAAD,EAAMC,GAAN,KAAc;AAC7B,MAAIV,cAAJ,EAAoB;AAClBS,IAAAA,GAAG,CAACf,IAAJ,CAASiB,GAAT,CAAa,OAAb,EAAsBjB,IAAtB;AACAe,IAAAA,GAAG,CAACb,MAAJ,CAAWe,GAAX,CAAe,OAAf,EAAwBf,MAAxB;;AACAc,IAAAA,GAAG,CAACE,GAAJ,CAAQlB,IAAR,CAAamB,KAAb,GAAqBC,GAAG,IAAIA,GAAG,CAACC,OAAJ,IAAeL,GAAG,CAACE,GAAJ,CAAQhB,MAAR,CAAeiB,KAAf,CAAqBC,GAArB,CAA3C;;AACAJ,IAAAA,GAAG,CAACE,GAAJ,CAAQhB,MAAR,CAAeiB,KAAf,GAAuBC,GAAG,IAAI,CAACA,GAAG,CAACE,GAAJ,KAAY,KAAZ,IAAqBF,GAAG,CAACE,GAAJ,KAAYX,SAAlC,KAAgDS,GAAG,CAACb,SAAJ,CAAcgB,iBAAd,CAAgCC,UAAhC,CAA2C,IAA3C,CAA9E;AACD;AACF,CAPD","sourcesContent":["const { sign: signOneShot, verify: verifyOneShot } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst { edDSASupported } = require('../help/runtime_support')\n\nconst sign = ({ [KEYOBJECT]: keyObject }, payload) => {\n  if (typeof payload === 'string') {\n    payload = Buffer.from(payload)\n  }\n  return signOneShot(undefined, payload, keyObject)\n}\n\nconst verify = ({ [KEYOBJECT]: keyObject }, payload, signature) => {\n  return verifyOneShot(undefined, payload, keyObject, signature)\n}\n\nmodule.exports = (JWA, JWK) => {\n  if (edDSASupported) {\n    JWA.sign.set('EdDSA', sign)\n    JWA.verify.set('EdDSA', verify)\n    JWK.OKP.sign.EdDSA = key => key.private && JWK.OKP.verify.EdDSA(key)\n    JWK.OKP.verify.EdDSA = key => (key.use === 'sig' || key.use === undefined) && key.keyObject.asymmetricKeyType.startsWith('ed')\n  }\n}\n"]},"metadata":{},"sourceType":"script"}