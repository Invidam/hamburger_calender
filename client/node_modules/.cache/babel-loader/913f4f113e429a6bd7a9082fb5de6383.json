{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { Deque } from \"../../classes/Deque\";\nimport { Node } from \"../../classes/Node\";\nimport { APIv2 } from \"../../tools/API\";\nimport { LocalStroage } from \"../../tools/LocalStorage\";\nimport { getAddedDateStr, getDiffDayInStr, subtractDayInStr } from \"../../tools/time\";\nexport const DISPLAY_LENGTH = 5;\nexport const ARRAY_LENGTH = 11;\n\nconst makeStartDate = date => getAddedDateStr(date, -1 * Math.floor(ARRAY_LENGTH / 2)); // const makeStartDate = (date) => getAddedDateStr(date, -1 * STARTDATEDIFF);\n\n\nconst getStartDate = date => LocalStroage.startDate().isEmpty() ? makeStartDate(date) : LocalStroage.startDate().get();\n\nlet befStartDate;\nlet listDeque;\n\nconst turnDeque = (deque, cnt, isLeft) => {\n  if (isLeft) {\n    // <-- 방향으로 이동\n    while (cnt--) {\n      deque.pop_front();\n      deque.push_back(new Node());\n    }\n  } else {\n    while (cnt--) {\n      deque.pop_back();\n      deque.push_front(new Node());\n    }\n  }\n};\n\nconst setDeque = (deque, arr, cnt, isLeft) => {\n  if (isLeft) {\n    // <-- 맨앞 요소를 없애고 맨앞에 arr요소들을 넣는다.\n    let idx = 0;\n    deque.pop_back(cnt);\n\n    while (idx < cnt) {\n      deque.push_back(new Node(arr[idx++]));\n    }\n  } else {\n    let idx = 0;\n    deque.pop_front(cnt);\n\n    while (cnt--) {\n      deque.push_front(new Node(arr[cnt]));\n    }\n  }\n};\n\nconst getEndDate = startDate => getAddedDateStr(startDate, ARRAY_LENGTH - 1);\n\nconst getDeqNeedDate = (startDate, dateDiff) => {\n  let endDate = getEndDate(startDate);\n  const isLeft = dateDiff > 0;\n\n  if (isLeft) {\n    startDate = getAddedDateStr(endDate, -1 * dateDiff + 1);\n  } else {\n    // 왼쪽 버튼 클릭 배열이 오른쪽 이동 왼쪽 요소들이 필요\n    endDate = getAddedDateStr(startDate, -1 * dateDiff - 1); // startDate = getAddedDateStr(startDate, dateDiff + 1);\n  }\n\n  return [startDate, endDate];\n}; // getAddedDateStr(startDate, ARRAY_LENGTH - 1);\n\n\nexport const useListView = (user, date, setDate) => {\n  _s();\n\n  const [startDate, setStratDate] = useState(getStartDate(date));\n  const [listView, setListView] = useState();\n  const [isListViewLoading, setLoad] = useState(false);\n\n  const updateStartDate = nextDate => {\n    LocalStroage.startDate().set(nextDate);\n    setStratDate(nextDate);\n  };\n\n  const onClickLeftBtn = () => {\n    if (isListViewLoading) return;\n    const nextDate = getAddedDateStr(startDate, -1);\n    updateStartDate(nextDate);\n  };\n\n  const onClickRightBtn = () => {\n    if (isListViewLoading) return;\n    const nextDate = getAddedDateStr(startDate, 1);\n    updateStartDate(nextDate);\n  };\n\n  const getListView = async (startDate, endDate) => {\n    try {\n      const data = await APIv2.listView(user, startDate, endDate, ARRAY_LENGTH).get();\n      if (!(data === null || data === void 0 ? void 0 : data.data)) throw new Error(\"List View cann't found\");\n      return data.data;\n    } catch (error) {\n      alert(error);\n    }\n  };\n\n  const updateListView = async () => {\n    if (user && startDate) {\n      const response = await getListView(startDate, getEndDate(startDate));\n      listDeque = new Deque(response, DISPLAY_LENGTH);\n      listDeque.print(\"MK LV?\");\n      setListView(listDeque.get());\n    }\n  };\n\n  const moveListView = async (startDate, dateDiff) => {\n    if (user && startDate) {\n      const isLeft = dateDiff > 0;\n      turnDeque(listDeque, Math.abs(dateDiff), isLeft);\n      const [needStartDate, needEndDate] = getDeqNeedDate(startDate, dateDiff);\n      setListView(listDeque.get());\n      const response = await getListView(needStartDate, needEndDate);\n      setDeque(listDeque, response, Math.abs(dateDiff), isLeft);\n    }\n  };\n\n  const MakeListView = async () => {\n    setLoad(true);\n    console.log(\"MK LV\"); //setListView를 좀 더 스마트하게 바꾸어야 한다.\n    //   \"[listview]Set list view start\",\n    //   listDeque,\n    //   befStartDate,\n    //   startDate\n    // );\n\n    const dateDiff = subtractDayInStr(befStartDate, startDate);\n    if (!listDeque || !befStartDate || dateDiff > 2 || dateDiff < -2) await updateListView();else if (dateDiff !== 0) await moveListView(startDate, dateDiff); // updateListView(startDate);\n\n    befStartDate = startDate; // return () => setLoad(false);\n\n    setLoad(false);\n  };\n\n  useEffect(() => {\n    updateStartDate(makeStartDate(date));\n  }, [date]);\n  useEffect(() => {\n    MakeListView();\n    return () => setLoad(false);\n  }, [startDate]);\n  return {\n    isListViewLoading,\n    startDate,\n    listView,\n    onClickLeftBtn,\n    onClickRightBtn,\n    updateListView\n  };\n}; // startTime 변경이 아닌ㄷ ㅏ른 방식으로 호출하여 에러 해결이 가능할 듯 하나 실제로 필요한진 몰겟드.\n\n_s(useListView, \"winhrkvjr+81rjeJ0SI6qLAjsAc=\");","map":{"version":3,"sources":["/home/invidam/hamburger_calender/src/hooks/listView/useListView.js"],"names":["useEffect","useState","Deque","Node","APIv2","LocalStroage","getAddedDateStr","getDiffDayInStr","subtractDayInStr","DISPLAY_LENGTH","ARRAY_LENGTH","makeStartDate","date","Math","floor","getStartDate","startDate","isEmpty","get","befStartDate","listDeque","turnDeque","deque","cnt","isLeft","pop_front","push_back","pop_back","push_front","setDeque","arr","idx","getEndDate","getDeqNeedDate","dateDiff","endDate","useListView","user","setDate","setStratDate","listView","setListView","isListViewLoading","setLoad","updateStartDate","nextDate","set","onClickLeftBtn","onClickRightBtn","getListView","data","Error","error","alert","updateListView","response","print","moveListView","abs","needStartDate","needEndDate","MakeListView","console","log"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { Deque } from \"../../classes/Deque\";\nimport { Node } from \"../../classes/Node\";\nimport { APIv2 } from \"../../tools/API\";\nimport { LocalStroage } from \"../../tools/LocalStorage\";\nimport {\n  getAddedDateStr,\n  getDiffDayInStr,\n  subtractDayInStr,\n} from \"../../tools/time\";\nexport const DISPLAY_LENGTH = 5;\nexport const ARRAY_LENGTH = 11;\nconst makeStartDate = (date) =>\n  getAddedDateStr(date, -1 * Math.floor(ARRAY_LENGTH / 2));\n// const makeStartDate = (date) => getAddedDateStr(date, -1 * STARTDATEDIFF);\nconst getStartDate = (date) =>\n  LocalStroage.startDate().isEmpty()\n    ? makeStartDate(date)\n    : LocalStroage.startDate().get();\n\nlet befStartDate;\nlet listDeque;\n\nconst turnDeque = (deque, cnt, isLeft) => {\n  if (isLeft) {\n    // <-- 방향으로 이동\n    while (cnt--) {\n      deque.pop_front();\n      deque.push_back(new Node());\n    }\n  } else {\n    while (cnt--) {\n      deque.pop_back();\n\n      deque.push_front(new Node());\n    }\n  }\n};\nconst setDeque = (deque, arr, cnt, isLeft) => {\n  if (isLeft) {\n    // <-- 맨앞 요소를 없애고 맨앞에 arr요소들을 넣는다.\n    let idx = 0;\n    deque.pop_back(cnt);\n    while (idx < cnt) {\n      deque.push_back(new Node(arr[idx++]));\n    }\n  } else {\n    let idx = 0;\n    deque.pop_front(cnt);\n    while (cnt--) {\n      deque.push_front(new Node(arr[cnt]));\n    }\n  }\n};\n\nconst getEndDate = (startDate) => getAddedDateStr(startDate, ARRAY_LENGTH - 1);\nconst getDeqNeedDate = (startDate, dateDiff) => {\n  let endDate = getEndDate(startDate);\n  const isLeft = dateDiff > 0;\n  if (isLeft) {\n    startDate = getAddedDateStr(endDate, -1 * dateDiff + 1);\n  } else {\n    // 왼쪽 버튼 클릭 배열이 오른쪽 이동 왼쪽 요소들이 필요\n    endDate = getAddedDateStr(startDate, -1 * dateDiff - 1);\n    // startDate = getAddedDateStr(startDate, dateDiff + 1);\n  }\n  return [startDate, endDate];\n};\n// getAddedDateStr(startDate, ARRAY_LENGTH - 1);\nexport const useListView = (user, date, setDate) => {\n  const [startDate, setStratDate] = useState(getStartDate(date));\n  const [listView, setListView] = useState();\n  const [isListViewLoading, setLoad] = useState(false);\n\n  const updateStartDate = (nextDate) => {\n    LocalStroage.startDate().set(nextDate);\n    setStratDate(nextDate);\n  };\n  const onClickLeftBtn = () => {\n    if (isListViewLoading) return;\n    const nextDate = getAddedDateStr(startDate, -1);\n    updateStartDate(nextDate);\n  };\n  const onClickRightBtn = () => {\n    if (isListViewLoading) return;\n    const nextDate = getAddedDateStr(startDate, 1);\n    updateStartDate(nextDate);\n  };\n\n  const getListView = async (startDate, endDate) => {\n    try {\n      const data = await APIv2.listView(\n        user,\n        startDate,\n        endDate,\n        ARRAY_LENGTH\n      ).get();\n      if (!data?.data) throw new Error(\"List View cann't found\");\n\n      return data.data;\n    } catch (error) {\n      alert(error);\n    }\n  };\n  const updateListView = async () => {\n    if (user && startDate) {\n      const response = await getListView(startDate, getEndDate(startDate));\n      listDeque = new Deque(response, DISPLAY_LENGTH);\n      listDeque.print(\"MK LV?\");\n      setListView(listDeque.get());\n    }\n  };\n  const moveListView = async (startDate, dateDiff) => {\n    if (user && startDate) {\n      const isLeft = dateDiff > 0;\n      turnDeque(listDeque, Math.abs(dateDiff), isLeft);\n      const [needStartDate, needEndDate] = getDeqNeedDate(startDate, dateDiff);\n      setListView(listDeque.get());\n\n      const response = await getListView(needStartDate, needEndDate);\n      setDeque(listDeque, response, Math.abs(dateDiff), isLeft);\n    }\n  };\n  const MakeListView = async () => {\n    setLoad(true);\n    console.log(\"MK LV\");\n    //setListView를 좀 더 스마트하게 바꾸어야 한다.\n\n    //   \"[listview]Set list view start\",\n    //   listDeque,\n    //   befStartDate,\n    //   startDate\n    // );\n    const dateDiff = subtractDayInStr(befStartDate, startDate);\n    if (!listDeque || !befStartDate || dateDiff > 2 || dateDiff < -2)\n      await updateListView();\n    else if (dateDiff !== 0) await moveListView(startDate, dateDiff);\n    // updateListView(startDate);\n    befStartDate = startDate;\n    // return () => setLoad(false);\n    setLoad(false);\n  };\n  useEffect(() => {\n    updateStartDate(makeStartDate(date));\n  }, [date]);\n  useEffect(() => {\n    MakeListView();\n    return () => setLoad(false);\n  }, [startDate]);\n  return {\n    isListViewLoading,\n    startDate,\n    listView,\n    onClickLeftBtn,\n    onClickRightBtn,\n    updateListView,\n  };\n};\n\n// startTime 변경이 아닌ㄷ ㅏ른 방식으로 호출하여 에러 해결이 가능할 듯 하나 실제로 필요한진 몰겟드.\n"]},"metadata":{},"sourceType":"module"}