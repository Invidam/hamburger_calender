{"ast":null,"code":"import _objectSpread from\"/home/invidam/hamburger_calender/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/invidam/hamburger_calender/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/invidam/hamburger_calender/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/invidam/hamburger_calender/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import{API}from\"../../../tools/API\";import{LocalStroage}from\"../../../tools/LocalStorage\";export var isEmptyWorkList=function isEmptyWorkList(workList){return workList?!Object.keys(workList).length:true;};export var isEmptyWork=function isEmptyWork(workObj){return workObj?!Object.keys(workObj).length:true;};var getEmptyWorkList=function getEmptyWorkList(){return{};};var checkWorkList=function checkWorkList(workList){return isEmptyWorkList(workList)?getEmptyWorkList():workList;};// const getInitList = (user) =>\n//   !user && window.localStorage.getItem(\"workList\")\n//     ? JSON.parse(window.localStorage.getItem(\"workList\"))\n//     : [];\nexport var useWorkList=function useWorkList(user,date){// const initList = getInitList();\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),isWorkListLoading=_useState2[0],setLoad=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),workList=_useState4[0],setWorkList=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),workTimeSum=_useState6[0],setWorkTimeSum=_useState6[1];var getWorkList=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var resWorkList,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!user){_context.next=14;break;}console.log(\"BEF: \",workList);setLoad(true);_context.next=6;return API.workList(user,date).get();case 6:data=_context.sent;setLoad(false);resWorkList=checkWorkList(data===null||data===void 0?void 0:data.data);console.log(\"USEWORKLIST, data catch\");console.log(\"USEWORKLIST DATA  CATCH  AFT\");setWorkList(resWorkList);_context.next=17;break;case 14:resWorkList=LocalStroage.workList().get();console.log(\"USEWORKLIST DATA NO CATCH [][] AFT\");setWorkList(resWorkList);case 17:_context.next=23;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](0);setLoad(false);alert(_context.t0);case 23:case\"end\":return _context.stop();}}},_callee,null,[[0,19]]);}));return function getWorkList(){return _ref.apply(this,arguments);};}();useEffect(function(){console.log(\"GET WORKLIST START\",date,user);getWorkList();return function(){return setLoad(false);};},[date,user]);var setWork=function setWork(workObj){console.log(\"SET WRORK START\");var id=workObj.id;var _workList=_objectSpread({},workList);return{create:function(){var _create=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_workList[id]=workObj;setWorkList(_workList);if(!user){_context2.next=7;break;}_context2.next=5;return API.work(user,date).create(workObj);case 5:_context2.next=8;break;case 7:LocalStroage.workList().set(_workList);case 8:case\"end\":return _context2.stop();}}},_callee2);}));function create(){return _create.apply(this,arguments);}return create;}(),edit:function(){var _edit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_workList[id]=workObj;setWorkList(_workList);if(!user){_context3.next=7;break;}_context3.next=5;return API.work(user,date).edit(workObj);case 5:_context3.next=8;break;case 7:LocalStroage.workList().set(_workList);case 8:case\"end\":return _context3.stop();}}},_callee3);}));function edit(){return _edit.apply(this,arguments);}return edit;}(),delete:function(){var _delete2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(delete _workList[id]){_context4.next=2;break;}throw new Error(\"Cannot Delete WorkItem\");case 2:setWorkList(_workList);console.log(\"IN USE WK, OBJ: \",workObj);if(!user){_context4.next=9;break;}_context4.next=7;return API.work(user,date).delete(workObj);case 7:_context4.next=10;break;case 9:LocalStroage.workList().set(_workList);case 10:case\"end\":return _context4.stop();}}},_callee4);}));function _delete(){return _delete2.apply(this,arguments);}return _delete;}()};};useEffect(function(){var sum=0;workList&&Object.values(workList).map(function(workItem,idx){sum+=workItem.workTime;});setWorkTimeSum(sum);},[workList]);return[workList,setWork,isWorkListLoading,workTimeSum];};","map":{"version":3,"sources":["/home/invidam/hamburger_calender/src/hooks/workList/work/useWorkList.js"],"names":["useEffect","useState","API","LocalStroage","isEmptyWorkList","workList","Object","keys","length","isEmptyWork","workObj","getEmptyWorkList","checkWorkList","useWorkList","user","date","isWorkListLoading","setLoad","setWorkList","workTimeSum","setWorkTimeSum","getWorkList","console","log","get","data","resWorkList","alert","setWork","id","_workList","create","work","set","edit","delete","Error","sum","values","map","workItem","idx","workTime"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { API } from \"../../../tools/API\";\nimport { LocalStroage } from \"../../../tools/LocalStorage\";\n\nexport const isEmptyWorkList = (workList) =>\n  workList ? !Object.keys(workList).length : true;\nexport const isEmptyWork = (workObj) =>\n  workObj ? !Object.keys(workObj).length : true;\nconst getEmptyWorkList = () => {\n  return {};\n};\nconst checkWorkList = (workList) =>\n  isEmptyWorkList(workList) ? getEmptyWorkList() : workList;\n\n// const getInitList = (user) =>\n//   !user && window.localStorage.getItem(\"workList\")\n//     ? JSON.parse(window.localStorage.getItem(\"workList\"))\n//     : [];\n\nexport const useWorkList = (user, date) => {\n  // const initList = getInitList();\n  const [isWorkListLoading, setLoad] = useState(false);\n  const [workList, setWorkList] = useState();\n  const [workTimeSum, setWorkTimeSum] = useState(0);\n  const getWorkList = async () => {\n    try {\n      let resWorkList;\n      if (user) {\n        console.log(\"BEF: \", workList);\n        setLoad(true);\n        const data = await API.workList(user, date).get();\n        setLoad(false);\n        resWorkList = checkWorkList(data?.data);\n        console.log(\"USEWORKLIST, data catch\");\n        console.log(\"USEWORKLIST DATA  CATCH  AFT\");\n        setWorkList(resWorkList);\n      } else {\n        resWorkList = LocalStroage.workList().get();\n        console.log(\"USEWORKLIST DATA NO CATCH [][] AFT\");\n        setWorkList(resWorkList);\n      }\n    } catch (error) {\n      setLoad(false);\n      alert(error);\n    }\n  };\n  useEffect(() => {\n    console.log(\"GET WORKLIST START\", date, user);\n    getWorkList();\n    return () => setLoad(false);\n  }, [date, user]);\n\n  const setWork = (workObj) => {\n    console.log(\"SET WRORK START\");\n    const id = workObj.id;\n    const _workList = { ...workList };\n    return {\n      create: async () => {\n        _workList[id] = workObj;\n        setWorkList(_workList);\n        if (user) await API.work(user, date).create(workObj);\n        else LocalStroage.workList().set(_workList);\n      },\n      edit: async () => {\n        _workList[id] = workObj;\n        setWorkList(_workList);\n        if (user) await API.work(user, date).edit(workObj);\n        else LocalStroage.workList().set(_workList);\n      },\n      delete: async () => {\n        if (!delete _workList[id]) throw new Error(\"Cannot Delete WorkItem\");\n        setWorkList(_workList);\n        console.log(\"IN USE WK, OBJ: \", workObj);\n        if (user) await API.work(user, date).delete(workObj);\n        else LocalStroage.workList().set(_workList);\n      },\n    };\n  };\n  useEffect(() => {\n    let sum = 0;\n    workList &&\n      Object.values(workList).map((workItem, idx) => {\n        sum += workItem.workTime;\n      });\n    setWorkTimeSum(sum);\n  }, [workList]);\n  return [workList, setWork, isWorkListLoading, workTimeSum];\n};\n"]},"metadata":{},"sourceType":"module"}