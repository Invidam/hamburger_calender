{"ast":null,"code":"import _objectSpread from\"/home/invidam/hamburger_calender/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/invidam/hamburger_calender/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/invidam/hamburger_calender/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/invidam/hamburger_calender/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import{SORT_TYPE_CNT}from\"../../components/todoList/TodoList\";// import { SORT_TYPE_CNT } from \"../../components/todoList/TodoListTemplate\";\nimport{API}from\"../../tools/API\";import{LocalStroage}from\"../../tools/LocalStorage\";var makeSortTypeStr=function makeSortTypeStr(idx){var ret={};ret[\"type\"]=Math.floor(idx/SORT_TYPE_CNT)===0?\"date\":\"priority\";ret[\"direction\"]=idx%2===0?\"up\":\"down\";return ret;};export var useTodoList=function useTodoList(user,initSortTypeIdx,sortTypeCnt,sortTypes){var _useState=useState(),_useState2=_slicedToArray(_useState,2),todoList=_useState2[0],setTodoList=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isTodoListLoading=_useState4[0],setLoad=_useState4[1];var _useState5=useState(initSortTypeIdx),_useState6=_slicedToArray(_useState5,2),sortTypeIdx=_useState6[0],setSortTypeIdx=_useState6[1];var getTodoListLength=function getTodoListLength(){return user?Object.keys(todoList).length:parseInt(Object.keys(todoList)[Object.keys(todoList).length-1])+1;};var getNextSortType=function getNextSortType(idx){return(idx+1)%sortTypes===0?idx-sortTypes+1:idx+1;};var onClickByTabIdx=function onClickByTabIdx(tabIdx){// 같은 소속이었다면\nsetLoad(true);if(Math.floor(sortTypeIdx/sortTypes)===tabIdx)setSortTypeIdx(getNextSortType(sortTypeIdx));else setSortTypeIdx(tabIdx*sortTypeCnt+1);};var getTodoList=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user,sortTypeIdx){var data,resTodoList,_resTodoList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!user){_context.next=15;break;}if(!isTodoListLoading)setLoad(true);console.log(\"TODO SORT\",sortTypeIdx);_context.next=6;return API.todoList(user).get(makeSortTypeStr(sortTypeIdx));case 6:data=_context.sent;resTodoList=data===null||data===void 0?void 0:data.data;console.log(\"INDI, RES TODO LIST: \",resTodoList);if(data){_context.next=11;break;}throw new Error(\"TodoList can't found\");case 11:setTodoList(resTodoList);setLoad(false);_context.next=19;break;case 15:_resTodoList=LocalStroage.todoList().get();console.log(\"USEWORKLIST DATA NO CATCH [][] AFT\");setTodoList(_resTodoList);setLoad(false);case 19:_context.next=24;break;case 21:_context.prev=21;_context.t0=_context[\"catch\"](0);alert(_context.t0);case 24:case\"end\":return _context.stop();}}},_callee,null,[[0,21]]);}));return function getTodoList(_x,_x2){return _ref.apply(this,arguments);};}();useEffect(function(){getTodoList(user,sortTypeIdx);},[user,sortTypeIdx]);var setTodo=function setTodo(todoObj,idx){// const id = todoObj.id;\n// let _todoList = todoList.concat();\n//getTodoListLength\nreturn{create:function(){var _create=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _todoList,_idx;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!user){_context2.next=7;break;}_context2.next=3;return API.todo(user).create(todoObj);case 3:_context2.next=5;return getTodoList(user,sortTypeIdx);case 5:_context2.next=13;break;case 7:_todoList=_objectSpread({},todoList);_idx=getTodoListLength();_todoList[_idx]=todoObj;console.log(\"CREATE TODO: \",_todoList);LocalStroage.todoList().set(_todoList);setTodoList(_todoList);case 13:case\"end\":return _context2.stop();}}},_callee2);}));function create(){return _create.apply(this,arguments);}return create;}(),edit:function(){var _edit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _todoList;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!user){_context3.next=7;break;}_context3.next=3;return API.todo(user).edit(todoObj);case 3:_context3.next=5;return getTodoList(user,sortTypeIdx);case 5:_context3.next=11;break;case 7:_todoList=_objectSpread({},todoList);_todoList[idx]=todoObj;LocalStroage.todoList().set(_todoList);setTodoList(_todoList);case 11:case\"end\":return _context3.stop();}}},_callee3);}));function edit(){return _edit.apply(this,arguments);}return edit;}(),delete:function(){var _delete2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _todoList;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!user){_context4.next=7;break;}_context4.next=3;return API.todo(user).delete(todoObj);case 3:_context4.next=5;return getTodoList(user,sortTypeIdx);case 5:_context4.next=12;break;case 7:_todoList=_objectSpread({},todoList);if(delete _todoList[idx]){_context4.next=10;break;}throw new Error(\"Cannot Delete TodoItem\");case 10:LocalStroage.todoList().set(_todoList);setTodoList(_todoList);case 12:case\"end\":return _context4.stop();}}},_callee4);}));function _delete(){return _delete2.apply(this,arguments);}return _delete;}()};};return[todoList,setTodo,isTodoListLoading,sortTypeIdx,onClickByTabIdx];};","map":{"version":3,"sources":["/home/invidam/hamburger_calender/client/src/hooks/todolist/useTodoList.js"],"names":["useEffect","useState","SORT_TYPE_CNT","API","LocalStroage","makeSortTypeStr","idx","ret","Math","floor","useTodoList","user","initSortTypeIdx","sortTypeCnt","sortTypes","todoList","setTodoList","isTodoListLoading","setLoad","sortTypeIdx","setSortTypeIdx","getTodoListLength","Object","keys","length","parseInt","getNextSortType","onClickByTabIdx","tabIdx","getTodoList","console","log","get","data","resTodoList","Error","alert","setTodo","todoObj","create","todo","_todoList","set","edit","delete"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { SORT_TYPE_CNT } from \"../../components/todoList/TodoList\";\n// import { SORT_TYPE_CNT } from \"../../components/todoList/TodoListTemplate\";\nimport { API } from \"../../tools/API\";\nimport { LocalStroage } from \"../../tools/LocalStorage\";\nconst makeSortTypeStr = (idx) => {\n  let ret = {};\n  ret[\"type\"] = Math.floor(idx / SORT_TYPE_CNT) === 0 ? \"date\" : \"priority\";\n  ret[\"direction\"] = idx % 2 === 0 ? \"up\" : \"down\";\n  return ret;\n};\nexport const useTodoList = (user, initSortTypeIdx, sortTypeCnt, sortTypes) => {\n  const [todoList, setTodoList] = useState();\n  const [isTodoListLoading, setLoad] = useState(true);\n  const [sortTypeIdx, setSortTypeIdx] = useState(initSortTypeIdx);\n  const getTodoListLength = () =>\n    user\n      ? Object.keys(todoList).length\n      : parseInt(Object.keys(todoList)[Object.keys(todoList).length - 1]) + 1;\n  const getNextSortType = (idx) =>\n    (idx + 1) % sortTypes === 0 ? idx - sortTypes + 1 : idx + 1;\n  const onClickByTabIdx = (tabIdx) => {\n    // 같은 소속이었다면\n    setLoad(true);\n    if (Math.floor(sortTypeIdx / sortTypes) === tabIdx)\n      setSortTypeIdx(getNextSortType(sortTypeIdx));\n    else setSortTypeIdx(tabIdx * sortTypeCnt + 1);\n  };\n  const getTodoList = async (user, sortTypeIdx) => {\n    try {\n      if (user) {\n        if (!isTodoListLoading) setLoad(true);\n        console.log(\"TODO SORT\", sortTypeIdx);\n        const data = await API.todoList(user).get(makeSortTypeStr(sortTypeIdx));\n        const resTodoList = data?.data;\n        console.log(\"INDI, RES TODO LIST: \", resTodoList);\n        if (!data) throw new Error(\"TodoList can't found\");\n        setTodoList(resTodoList);\n        setLoad(false);\n      } else {\n        const resTodoList = LocalStroage.todoList().get();\n        console.log(\"USEWORKLIST DATA NO CATCH [][] AFT\");\n        setTodoList(resTodoList);\n        setLoad(false);\n      }\n    } catch (error) {\n      alert(error);\n    }\n  };\n  useEffect(() => {\n    getTodoList(user, sortTypeIdx);\n  }, [user, sortTypeIdx]);\n  const setTodo = (todoObj, idx) => {\n    // const id = todoObj.id;\n    // let _todoList = todoList.concat();\n    //getTodoListLength\n    return {\n      create: async () => {\n        // _todoList.push([id, todoObj]);\n        // _todoList.push(todoObj);\n        if (user) {\n          await API.todo(user).create(todoObj);\n          await getTodoList(user, sortTypeIdx);\n        } else {\n          const _todoList = { ...todoList };\n          const idx = getTodoListLength();\n          _todoList[idx] = todoObj;\n          console.log(\"CREATE TODO: \", _todoList);\n          LocalStroage.todoList().set(_todoList);\n          setTodoList(_todoList);\n        }\n      },\n      edit: async () => {\n        // _todoList[idx] = [id, todoObj];\n\n        // _todoList[idx] = todoObj;\n        // setTodoList(_todoList);\n        if (user) {\n          await API.todo(user).edit(todoObj);\n          await getTodoList(user, sortTypeIdx);\n        } else {\n          const _todoList = { ...todoList };\n          _todoList[idx] = todoObj;\n          LocalStroage.todoList().set(_todoList);\n          setTodoList(_todoList);\n        }\n      },\n      delete: async () => {\n        // _todoList = _todoList.filter((el, elemIdx) => elemIdx !== idx);\n        // setTodoList(_todoList);\n        if (user) {\n          await API.todo(user).delete(todoObj);\n          await getTodoList(user, sortTypeIdx);\n        } else {\n          const _todoList = { ...todoList };\n          if (!delete _todoList[idx]) throw new Error(\"Cannot Delete TodoItem\");\n          LocalStroage.todoList().set(_todoList);\n          setTodoList(_todoList);\n        }\n      },\n    };\n  };\n  return [todoList, setTodo, isTodoListLoading, sortTypeIdx, onClickByTabIdx];\n};\n"]},"metadata":{},"sourceType":"module"}